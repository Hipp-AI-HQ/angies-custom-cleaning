---
phase: 03-residential-site
plan: 04
type: execute
wave: 1
depends_on: []
files_modified:
  - residential/js/main.js
autonomous: true

must_haves:
  truths:
    - "Statistics counters animate from 0 to target numbers when scrolled into view"
    - "Form submission shows demo alert acknowledging submission"
    - "CountUp.js loads from CDN before main.js executes"
    - "IntersectionObserver triggers animation at 50% visibility threshold"
  artifacts:
    - path: "residential/js/main.js"
      provides: "Statistics animation and form handling"
      min_lines: 60
      exports: ["countUpStats", "handleFormSubmit"]
  key_links:
    - from: "residential/index.html"
      to: "https://cdn.jsdelivr.net/npm/countup@2.8.0/dist/countUp.min.js"
      via: "script src CDN"
      pattern: "countup.*\\.min\\.js"
    - from: "residential/index.html"
      to: "residential/js/main.js"
      via: "script src local"
      pattern: "js/main\\.js"
    - from: "residential/js/main.js"
      to: "residential/index.html #stats .stat__number"
      via: "querySelectorAll + CountUp instances"
      pattern: "data-count"
---

<objective>
Wire JavaScript functionality by copying and integrating commercial site's main.js for statistics animation and form handling.

Purpose: Reuse proven Phase 2 JavaScript patterns to provide interactive statistics counters and demo form submission handling on residential site.

Output: Copied main.js with CountUp.js CDN integration and IntersectionObserver-based animation triggering.
</objective>

<execution_context>
@/Users/dillonhippensteel/clients/angies-custom-cleaning/.claude/get-shit-done/workflows/execute-plan.md
@/Users/dillonhippensteel/clients/angies-custom-cleaning/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@/Users/dillonhippensteel/clients/angies-custom-cleaning/.planning/PROJECT.md
@/Users/dillonhippensteel/clients/angies-custom-cleaning/.planning/ROADMAP.md
@/Users/dillonhippensteel/clients/angies-custom-cleaning/.planning/STATE.md
@/Users/dillonhippensteel/clients/angies-custom-cleaning/.planning/phases/03-residential-site/03-RESEARCH.md

<!-- Phase 2 JavaScript implementation -->
@/Users/dillonhippensteel/clients/angies-custom-cleaning/commercial/js/main.js
@/Users/dillonhippensteel/clients/angies-custom-cleaning/.planning/phases/02-commercial-site/02-04-SUMMARY.md
</context>

<tasks>

<task type="auto">
  <name>Copy JavaScript and wire CountUp.js</name>
  <files>residential/js/main.js</files>
  <action>
    Copy commercial/js/main.js to residential/js/main.js and verify CountUp.js CDN script tag in index.html:

    **Step 1: Create residential/js/ directory and copy main.js**
    ```bash
    mkdir -p residential/js
    cp commercial/js/main.js residential/js/main.js
    ```

    **Step 2: Verify index.html has CountUp.js CDN script**

    residential/index.html should have these script tags before closing </body>:
    ```html
    <!-- CountUp.js from CDN (Phase 2 pattern) -->
    <script src="https://cdn.jsdelivr.net/npm/countup@2.8.0/dist/countUp.min.js"></script>

    <!-- Site JavaScript -->
    <script src="js/main.js"></script>
    ```

    If index.html from Plan 02 is missing these, add them before </body> tag.

    **What main.js does (from Phase 2):**

    1. **Statistics Animation:**
       - Selects all `.stat__number` elements with data-count attributes
       - Creates CountUp instances for each statistic
       - Uses IntersectionObserver to trigger animation when stats section is 50% visible
       - Handles data-suffix attribute for + or % suffixes
       - Animates once per page load (unobserve after first trigger)

    2. **Form Submission:**
       - Selects contact form by ID
       - Prevents default submission
       - Shows demo alert acknowledging submission
       - Resets form fields

    The residential site uses same data-count attributes on statistics (12 years, 1500+ homes, 100%, 1 family), so no code changes needed - direct copy works.

    **Verify script integration:**
    - CountUp.js CDN loads before main.js
    - main.js executes after DOM ready
    - No console errors on page load
    - Statistics section uses correct selectors (.stat__number with data-count)
  </action>
  <verify>
    ls residential/js/main.js  # Verify file exists
    wc -l residential/js/main.js  # Should be 60+ lines (same as commercial)
    grep "countup" residential/index.html  # Verify CDN script tag
    grep "js/main.js" residential/index.html  # Verify local script tag
    diff commercial/js/main.js residential/js/main.js  # Should show no differences
  </verify>
  <done>
    residential/js/main.js exists, index.html includes CountUp.js CDN and main.js script tags, and JavaScript is ready to animate statistics and handle form submission.
  </done>
</task>

</tasks>

<verification>
Run all task verification commands:
- main.js copied to residential/js/
- index.html includes CountUp.js CDN script
- index.html includes main.js script
- Files are identical to commercial site version
</verification>

<success_criteria>
Plan complete when:
- residential/js/main.js exists as direct copy of commercial/js/main.js
- residential/index.html includes CountUp.js CDN script tag
- residential/index.html includes main.js script tag before closing body
- No code changes needed (residential stats use same data-count pattern)
</success_criteria>

<output>
After completion, create `.planning/phases/03-residential-site/03-04-SUMMARY.md` documenting:
- JavaScript integration approach (direct copy)
- CountUp.js CDN version and loading pattern
- Statistics animation mechanism (IntersectionObserver)
- Form handling implementation
- Files created and verification results
</output>
