---
phase: 04-polish-interactivity
plan: 03
type: execute
wave: 1
depends_on: []
files_modified:
  - commercial/index.html
  - commercial/css/components.css
  - commercial/js/main.js
  - residential/index.html
  - residential/css/components.css
  - residential/js/main.js
autonomous: true

must_haves:
  truths:
    - "On mobile, tapping hamburger icon opens slide-in navigation menu"
    - "On mobile, navigation menu slides in from right side covering viewport"
    - "On mobile, tapping a navigation link closes menu and scrolls to section"
    - "On mobile, tapping overlay backdrop closes menu"
    - "On mobile, pressing Escape key closes menu"
    - "On desktop (> 768px), navigation links are visible in header (no hamburger)"
  artifacts:
    - path: "commercial/index.html"
      provides: "Hamburger button HTML with ARIA attributes"
      contains: "hamburger"
    - path: "commercial/css/components.css"
      provides: "Hamburger animation, slide-in nav, overlay backdrop styles"
      contains: "hamburger__line"
    - path: "commercial/js/main.js"
      provides: "Menu toggle function with accessibility (focus management, Escape key)"
      contains: "toggleMenu"
    - path: "residential/index.html"
      provides: "Hamburger button matching commercial structure"
      contains: "hamburger"
    - path: "residential/css/components.css"
      provides: "Menu styles matching commercial"
      contains: "hamburger__line"
  key_links:
    - from: ".hamburger button"
      to: "toggleMenu() function"
      via: "click event listener"
      pattern: "hamburger.*addEventListener.*click"
    - from: "toggleMenu()"
      to: "nav.is-open class"
      via: "classList.toggle"
      pattern: "nav.*classList.*toggle"
    - from: "nav.is-open"
      to: "right: 0 CSS"
      via: "CSS transition on right property"
      pattern: "nav\\.is-open.*right: 0"
---

<objective>
Add mobile hamburger menu with slide-in navigation for both sites, including full accessibility support (ARIA, focus management, keyboard controls).

Purpose: Complete mobile UX by adding accessible navigation menu that was deferred from Phases 2-3. Navigation is currently hidden on mobile — this plan makes it accessible via hamburger menu while maintaining desktop header navigation.

Output: Both commercial and residential sites have functional hamburger menu on mobile (<= 768px) with slide-in navigation from right, overlay backdrop, and complete accessibility (ARIA attributes, focus management, Escape key to close).
</objective>

<execution_context>
@~/.claude/get-shit-done/workflows/execute-plan.md
@~/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/REQUIREMENTS.md
@.planning/phases/04-polish-interactivity/04-RESEARCH.md
@commercial/index.html
@commercial/css/components.css
@commercial/js/main.js
@residential/index.html
@residential/css/components.css
@residential/js/main.js
</context>

<tasks>

<task type="auto">
  <name>Task 1: Add hamburger button HTML to both sites</name>
  <files>commercial/index.html, residential/index.html</files>
  <action>
Add hamburger button to header on BOTH sites. Modify existing `<header class="site-header">` section.

**Find the header structure** (should look like this):
```html
<header class="site-header">
  <div class="container">
    <a href="#hero" class="logo">
      <img src="images/logo.png" alt="Angie's Custom Cleaning">
    </a>

    <nav>
      <ul>
        <li><a href="#services">Services</a></li>
        <li><a href="#why-us">Why Choose Us</a></li>
        <!-- ... more nav links ... -->
      </ul>
    </nav>

    <a href="tel:+17176150968" class="phone-link">717-615-0968</a>
  </div>
</header>
```

**Insert hamburger button AFTER logo, BEFORE nav:**
```html
<header class="site-header">
  <div class="container">
    <a href="#hero" class="logo">
      <img src="images/logo.png" alt="Angie's Custom Cleaning">
    </a>

    <!-- Hamburger button (mobile only) -->
    <button
      class="hamburger"
      aria-label="Menu"
      aria-expanded="false"
      aria-controls="nav-menu"
      type="button"
    >
      <span class="hamburger__line"></span>
      <span class="hamburger__line"></span>
      <span class="hamburger__line"></span>
    </button>

    <nav id="nav-menu" aria-label="Primary navigation">
      <ul>
        <li><a href="#services">Services</a></li>
        <li><a href="#why-us">Why Choose Us</a></li>
        <!-- ... existing nav links ... -->
      </ul>
    </nav>

    <a href="tel:+17176150968" class="phone-link">717-615-0968</a>
  </div>
</header>
```

**Changes:**
1. Add `<button class="hamburger">` with three `.hamburger__line` spans
2. Add ARIA attributes: `aria-label="Menu"`, `aria-expanded="false"`, `aria-controls="nav-menu"`, `type="button"`
3. Add `id="nav-menu"` to existing `<nav>` element
4. Add `aria-label="Primary navigation"` to existing `<nav>` element

Apply to BOTH commercial and residential sites with identical structure.

**Verify nav links** - They should include (at minimum):
- Commercial: Services, Why Choose Us, How It Works, About, Contact
- Residential: Services, Why Choose Us, How It Works, Gift Cards, About, Contact

If navigation is currently missing links, do NOT add them in this task — focus on hamburger structure only.
  </action>
  <verify>
```bash
# Check hamburger button exists in both sites
grep -n "hamburger" commercial/index.html
grep -n "hamburger" residential/index.html

# Check ARIA attributes
grep "aria-expanded" commercial/index.html
grep "aria-controls" commercial/index.html

# Check nav has id and aria-label
grep 'id="nav-menu"' commercial/index.html
grep 'aria-label="Primary navigation"' commercial/index.html

# Verify three hamburger lines
grep -c "hamburger__line" commercial/index.html
```
  </verify>
  <done>Both index.html files contain hamburger button with three .hamburger__line spans, ARIA attributes (aria-label, aria-expanded, aria-controls), and nav element has id="nav-menu" and aria-label="Primary navigation"</done>
</task>

<task type="auto">
  <name>Task 2: Add hamburger and navigation CSS to both sites</name>
  <files>commercial/css/components.css, residential/css/components.css</files>
  <action>
Add hamburger button, navigation slide-in, and overlay styles to components.css on BOTH sites. Append after existing button/card hover effects (or after mobile CTA if Plan 04-02 hasn't run yet).

```css
/* ==========================================================================
   Mobile Hamburger Menu
   Three-line hamburger icon with X animation on open
   ========================================================================== */

.hamburger {
  display: none; /* Hidden on desktop */

  @media (max-width: 768px) {
    display: flex;
    flex-direction: column;
    gap: 6px;
    background: transparent;
    border: none;
    cursor: pointer;
    padding: var(--space-sm);
    z-index: var(--z-hamburger);
    position: relative;

    /* Remove tap highlight */
    -webkit-tap-highlight-color: transparent;
  }
}

.hamburger__line {
  width: 28px;
  height: 3px;
  background-color: var(--color-primary);
  border-radius: 2px;
  transition: transform var(--transition-base), opacity var(--transition-fast);
}

/* Hamburger animation: X transform when menu is open */
.hamburger[aria-expanded="true"] .hamburger__line:nth-child(1) {
  transform: translateY(9px) rotate(45deg);
}

.hamburger[aria-expanded="true"] .hamburger__line:nth-child(2) {
  opacity: 0;
}

.hamburger[aria-expanded="true"] .hamburger__line:nth-child(3) {
  transform: translateY(-9px) rotate(-45deg);
}

/* ==========================================================================
   Mobile Navigation Slide-In
   Navigation slides in from right side on mobile
   ========================================================================== */

/* Desktop: Navigation visible in header (existing behavior) */
nav {
  /* Desktop styles remain unchanged */
}

/* Mobile: Navigation becomes full-screen slide-in */
@media (max-width: 768px) {
  nav {
    position: fixed;
    top: 0;
    right: -100%; /* Off-screen by default */
    width: 280px;
    max-width: 80vw;
    height: 100vh;
    background-color: var(--color-surface);
    box-shadow: var(--shadow-xl);
    z-index: var(--z-menu);

    /* Slide animation */
    transition: right var(--transition-slow);

    /* Overflow */
    overflow-y: auto;

    /* Padding */
    padding: var(--space-3xl) var(--space-xl);
  }

  /* Show navigation when menu is open */
  nav.is-open {
    right: 0; /* Slide in */
  }

  /* Navigation list styling for mobile */
  nav ul {
    list-style: none;
    padding: 0;
    margin: 0;
    display: flex;
    flex-direction: column;
    gap: var(--space-lg);
  }

  nav ul li {
    margin: 0;
  }

  nav ul li a {
    display: block;
    padding: var(--space-sm) 0;
    font-size: var(--fs-md);
    font-weight: 600;
    color: var(--color-text);
    text-decoration: none;
    transition: color var(--transition-fast);
  }

  nav ul li a:hover,
  nav ul li a:focus {
    color: var(--color-primary);
  }
}

/* ==========================================================================
   Navigation Overlay Backdrop
   Semi-transparent backdrop when mobile menu is open
   ========================================================================== */

.nav-overlay {
  display: none;

  @media (max-width: 768px) {
    position: fixed;
    top: 0;
    left: 0;
    width: 100vw;
    height: 100vh;
    background-color: rgba(0, 0, 0, 0.5);
    z-index: var(--z-overlay);
    opacity: 0;
    transition: opacity var(--transition-base);
    pointer-events: none;
  }
}

.nav-overlay.is-visible {
  display: block;
  opacity: 1;
  pointer-events: auto;
}
```

Apply IDENTICAL styling to both commercial and residential sites.

**Important:**
- Use @media (max-width: 768px) to match existing breakpoints
- Use existing CSS variables (--color-primary, --color-surface, --space-*, --shadow-xl, --transition-*, --z-*)
- Desktop nav styles remain unchanged (this only affects mobile)
- Slide from RIGHT (right: -100% to right: 0)
- If components.css doesn't exist yet, create it with this content
  </action>
  <verify>
```bash
# Check hamburger styles exist
grep -n "hamburger" commercial/css/components.css
grep -n "hamburger__line" commercial/css/components.css

# Check navigation slide-in exists
grep -n "nav.is-open" commercial/css/components.css

# Check overlay exists
grep -n "nav-overlay" commercial/css/components.css

# Verify mobile media query
grep -c "@media (max-width: 768px)" commercial/css/components.css

# Should match on residential too
grep -n "hamburger" residential/css/components.css
grep -n "nav.is-open" residential/css/components.css
```
  </verify>
  <done>Both components.css files contain hamburger button styles (three lines, X animation on aria-expanded=true), mobile navigation slide-in styles (fixed position, right: -100% to right: 0, z-index from variable), and overlay backdrop styles (semi-transparent black, z-index 999)</done>
</task>

<task type="auto">
  <name>Task 3: Add menu toggle JavaScript to both sites</name>
  <files>commercial/js/main.js, residential/js/main.js</files>
  <action>
Add mobile menu toggle functionality to main.js on BOTH sites. Append at END of file (after any existing code).

```javascript
/**
 * Mobile Hamburger Menu
 * Toggle slide-in navigation with full accessibility support
 */
document.addEventListener('DOMContentLoaded', function() {
  const hamburger = document.querySelector('.hamburger');
  const nav = document.querySelector('nav');
  const navLinks = document.querySelectorAll('nav a');

  // Exit if elements not found
  if (!hamburger || !nav) {
    console.warn('Hamburger menu elements not found');
    return;
  }

  // Create overlay backdrop
  const overlay = document.createElement('div');
  overlay.className = 'nav-overlay';
  document.body.appendChild(overlay);

  /**
   * Toggle mobile menu open/closed
   */
  function toggleMenu() {
    const isOpen = hamburger.getAttribute('aria-expanded') === 'true';

    // Update ARIA state
    hamburger.setAttribute('aria-expanded', !isOpen);

    // Toggle classes
    nav.classList.toggle('is-open');
    overlay.classList.toggle('is-visible');

    // Prevent body scroll when menu is open
    document.body.style.overflow = !isOpen ? 'hidden' : '';

    // Focus management
    if (!isOpen) {
      // Opening menu: focus first link after animation
      const firstLink = nav.querySelector('a');
      if (firstLink) {
        setTimeout(() => firstLink.focus(), 300);
      }
    } else {
      // Closing menu: return focus to hamburger
      hamburger.focus();
    }
  }

  // Event: Hamburger button click
  hamburger.addEventListener('click', toggleMenu);

  // Event: Nav link click (close menu after selecting)
  navLinks.forEach(link => {
    link.addEventListener('click', function() {
      if (nav.classList.contains('is-open')) {
        toggleMenu();
      }
    });
  });

  // Event: Overlay click (close menu)
  overlay.addEventListener('click', toggleMenu);

  // Event: Escape key (close menu)
  document.addEventListener('keydown', function(e) {
    if (e.key === 'Escape' && nav.classList.contains('is-open')) {
      toggleMenu();
    }
  });
});
```

Apply IDENTICAL code to both commercial and residential sites.

**Why this approach:**
- Follows existing code patterns (DOMContentLoaded, querySelector, console.warn)
- Creates overlay element via JavaScript (no HTML change needed beyond hamburger button)
- Full accessibility: ARIA state management, focus management, Escape key support
- Body scroll prevention when menu open (better mobile UX)
- Menu closes on nav link click (expected behavior)

**Matches research pattern from 04-RESEARCH.md lines 422-481.**
  </action>
  <verify>
```bash
# Check toggleMenu function exists
grep -n "toggleMenu" commercial/js/main.js
grep -n "toggleMenu" residential/js/main.js

# Check ARIA state management
grep "aria-expanded" commercial/js/main.js

# Check overlay creation
grep "nav-overlay" commercial/js/main.js

# Check event listeners
grep "hamburger.addEventListener" commercial/js/main.js
grep "Escape" commercial/js/main.js

# Verify body scroll prevention
grep "body.style.overflow" commercial/js/main.js

# Should match on residential
grep -n "toggleMenu" residential/js/main.js
```
  </verify>
  <done>Both main.js files contain toggleMenu() function with ARIA state management (aria-expanded toggle), overlay creation and management (.nav-overlay element), event listeners (hamburger click, nav link click, overlay click, Escape key), focus management (focus first link on open, return to hamburger on close), and body scroll prevention (overflow: hidden when open)</done>
</task>

</tasks>

<verification>
**Manual testing (both sites):**

1. **Test hamburger appears on mobile**
   - Open commercial site in browser
   - DevTools → Responsive mode → 375px width
   - Hamburger icon (three horizontal lines) should be visible in header
   - Desktop (> 768px) → hamburger should NOT be visible
   - Repeat for residential site

2. **Test menu open/close (mobile)**
   - Mobile viewport (375px)
   - Click hamburger icon
   - Navigation menu should slide in from right side
   - Menu should cover most of viewport (280px width or 80vw)
   - Semi-transparent black overlay should appear behind menu
   - Hamburger icon should animate to X shape (three lines become X)
   - Repeat for residential site

3. **Test menu close methods (mobile)**
   - Open menu via hamburger
   - **Method 1:** Click hamburger again → menu should slide out, overlay disappears
   - Open menu again
   - **Method 2:** Click overlay backdrop → menu should close
   - Open menu again
   - **Method 3:** Press Escape key → menu should close
   - Open menu again
   - **Method 4:** Click any nav link → menu should close AND page should scroll to section
   - Repeat all methods on residential site

4. **Test body scroll prevention (mobile)**
   - Mobile viewport, scroll to middle of page
   - Open menu → should NOT be able to scroll page content behind menu
   - Close menu → scrolling should work again
   - Repeat for residential site

5. **Test focus management (mobile)**
   - Mobile viewport
   - Tab to hamburger button (keyboard navigation)
   - Press Enter to open menu
   - Focus should automatically move to first nav link in menu
   - Press Escape to close → focus returns to hamburger button
   - Repeat for residential site

6. **Test ARIA attributes**
   - Open DevTools → Elements → Find hamburger button
   - Check aria-expanded="false" when closed
   - Open menu → aria-expanded should change to "true"
   - Close menu → aria-expanded should change back to "false"
   - Repeat for residential site

7. **Test desktop navigation unchanged**
   - Desktop viewport (1024px+)
   - Navigation links should be visible in header (NOT in slide-in menu)
   - Hamburger should be hidden
   - All nav links should work (smooth scroll to sections)
   - Repeat for residential site

**Expected results:**
- Hamburger visible on mobile only (<= 768px)
- Menu slides in from right smoothly (400ms transition)
- Menu closes via hamburger, overlay, Escape, or nav link click
- Body scroll prevented when menu open
- Focus management works for keyboard users
- ARIA state updates correctly
- Desktop navigation unchanged (no hamburger, nav in header)
- Identical behavior on both sites
</verification>

<success_criteria>
**Hamburger menu working:**
- User opens commercial site on mobile (375px) → hamburger icon visible in header (three horizontal blue lines)
- User taps hamburger → navigation menu slides in from right side, overlay appears, hamburger animates to X
- User sees navigation links in vertical list (Services, Why Choose Us, How It Works, About, Contact)
- Menu covers ~280px width or 80% of viewport, white background, drop shadow

**Menu closes correctly:**
- User taps hamburger (now X) → menu slides out, overlay fades, X animates back to three lines
- User opens menu, taps overlay → menu closes
- User opens menu, presses Escape key → menu closes
- User opens menu, taps "Services" link → menu closes AND page scrolls to Services section

**Accessibility working:**
- User tabs to hamburger button, presses Enter → menu opens, focus moves to first nav link
- User presses Escape → menu closes, focus returns to hamburger button
- Screen reader announces "Menu" for hamburger button, "Primary navigation" for nav
- aria-expanded attribute toggles between "false" (closed) and "true" (open)

**Body scroll prevented:**
- User opens menu on mobile → page content behind menu does NOT scroll
- User closes menu → scrolling works again normally

**Desktop unchanged:**
- User opens site on desktop (1024px+) → no hamburger visible, navigation links in header as before
- All nav links work with smooth scrolling (no change to existing behavior)

**Both sites identical:**
- Commercial and residential sites have identical hamburger menu behavior
- Only difference: residential has additional "Gift Cards" nav link
- Animation timing, styling, and interactions match across both sites

**Performance:**
- Menu slide-in animation is smooth (60fps, no jank)
- No console errors when opening/closing menu
- Overlay appears/disappears smoothly with fade transition
</success_criteria>

<output>
After completion, create `.planning/phases/04-polish-interactivity/04-03-SUMMARY.md` documenting:
- Hamburger button structure (HTML with ARIA attributes)
- CSS implementation (hamburger animation, slide-in nav, overlay)
- JavaScript implementation (toggleMenu function, event listeners, focus management)
- Accessibility features (ARIA state, focus management, Escape key, body scroll prevention)
- Verification results (manual testing notes for all close methods)
- Any issues encountered or deviations from plan
</output>
