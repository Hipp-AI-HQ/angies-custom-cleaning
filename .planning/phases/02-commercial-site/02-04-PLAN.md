---
phase: 02-commercial-site
plan: 04
type: execute
wave: 4
depends_on: ["02-02", "02-03"]
files_modified:
  - commercial/js/main.js
autonomous: true

must_haves:
  truths:
    - "Opening commercial/index.html shows statistics counters animating from 0 to target values when scrolling to stats section"
    - "Statistics animation only triggers once (doesn't repeat on subsequent scrolls)"
    - "Form submission shows alert message instead of attempting real submission"
    - "CountUp.js loads successfully from CDN with no console errors"
  artifacts:
    - path: "commercial/js/main.js"
      provides: "Statistics counter animation and form placeholder behavior"
      min_lines: 30
      contains: "CountUp"
    - path: "commercial/index.html"
      provides: "CountUp.js CDN script tag"
      contains: "countup"
  key_links:
    - from: "commercial/js/main.js"
      to: "commercial/index.html"
      via: "querySelector selecting .stat__number elements"
      pattern: "querySelectorAll.*stat__number"
    - from: "commercial/index.html"
      to: "https://cdn.jsdelivr.net/npm/countup"
      via: "<script> tag loading CountUp.js"
      pattern: "<script.*countup"
---

<objective>
Add JavaScript enhancements to the commercial site: animated statistics counters using CountUp.js that trigger on scroll, and form placeholder behavior that alerts users the form is for demo purposes only. These enhancements improve the polish and professionalism of the demo without adding heavy dependencies.

Purpose: This plan adds the final interactive touches that make the site feel premium. Statistics animation creates visual interest and draws attention to business credentials. The form alert ensures visitors understand this is a demo and don't expect real form submission.

Output: A main.js file with CountUp.js implementation and form handling, plus CDN script tag added to index.html.
</objective>

<execution_context>
@/Users/dillonhippensteel/clients/angies-custom-cleaning/.claude/get-shit-done/workflows/execute-plan.md
@/Users/dillonhippensteel/clients/angies-custom-cleaning/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@/Users/dillonhippensteel/clients/angies-custom-cleaning/.planning/PROJECT.md
@/Users/dillonhippensteel/clients/angies-custom-cleaning/.planning/ROADMAP.md
@/Users/dillonhippensteel/clients/angies-custom-cleaning/.planning/STATE.md
@/Users/dillonhippensteel/clients/angies-custom-cleaning/.planning/phases/02-commercial-site/02-RESEARCH.md
@/Users/dillonhippensteel/clients/angies-custom-cleaning/CLAUDE.md

# Reference HTML structure with statistics section and form
@/Users/dillonhippensteel/clients/angies-custom-cleaning/commercial/index.html
</context>

<tasks>

<task type="auto">
  <name>Task 1: Implement CountUp.js statistics animation</name>
  <files>
    commercial/js/main.js
  </files>
  <action>
    Create commercial/js/main.js with CountUp.js implementation following the pattern from 02-RESEARCH.md (Statistics Counter example).

    ```javascript
    /**
     * Initialize statistics counters with CountUp.js
     * Animates numbers from 0 to target value when section scrolls into view
     */
    document.addEventListener('DOMContentLoaded', function() {
      const counters = document.querySelectorAll('.stat__number');

      // Exit if no counters found
      if (!counters.length) {
        console.warn('No .stat__number elements found for animation');
        return;
      }

      // CountUp.js options
      const options = {
        duration: 2.5,
        useEasing: true,
        useGrouping: true,
        separator: ',',
      };

      // Intersection Observer for scroll-triggered animation
      const observer = new IntersectionObserver((entries) => {
        entries.forEach(entry => {
          if (entry.isIntersecting) {
            const el = entry.target;
            const count = parseInt(el.dataset.count);
            const suffix = el.dataset.suffix || '';
            const prefix = el.dataset.prefix || '';

            // Validate count value
            if (isNaN(count)) {
              console.error('Invalid data-count value:', el.dataset.count);
              return;
            }

            // Initialize CountUp
            const countUp = new CountUp(el, count, {
              ...options,
              suffix: suffix,
              prefix: prefix
            });

            if (!countUp.error) {
              countUp.start();
            } else {
              console.error('CountUp error:', countUp.error);
            }

            // Unobserve after animation (animate only once)
            observer.unobserve(el);
          }
        });
      }, { threshold: 0.5 }); // Trigger when 50% of stats section is visible

      // Observe all counter elements
      counters.forEach(counter => observer.observe(counter));
    });
    ```

    This implementation:
    - Waits for DOM to be ready
    - Selects all .stat__number elements (created in Plan 02, styled in Plan 03)
    - Uses IntersectionObserver to detect when stats section scrolls into view
    - Animates each number from 0 to target value (from data-count attribute)
    - Supports optional suffix (e.g., "+") and prefix (e.g., "$") via data attributes
    - Only animates once (unobserves after first trigger)
    - Includes error handling for missing elements or invalid data

    IMPORTANT: This task depends on Plan 02 (HTML structure with .stat__number elements) AND Plan 03 (CSS classes being present). JavaScript queries for .stat__number class and data-count attributes established in earlier plans.

    Follow best practices: proper error handling, console warnings for debugging, comments explaining intent.
  </action>
  <verify>
    Create main.js, then temporarily add a test script tag to index.html to verify syntax: `node -c commercial/js/main.js` (checks for syntax errors). Or simply open index.html in browser and check console for errors (CountUp will not be defined yet until CDN added in Task 2).
  </verify>
  <done>
    commercial/js/main.js exists with CountUp.js implementation including IntersectionObserver, proper error handling, and animation logic ready to trigger when stats section scrolls into view.
  </done>
</task>

<task type="auto">
  <name>Task 2: Add CountUp.js CDN and wire form alert behavior</name>
  <files>
    commercial/index.html
    commercial/js/main.js
  </files>
  <action>
    Update commercial/index.html to load CountUp.js from CDN and main.js:

    Add before closing </body> tag (after all other content):
    ```html
    <!-- CountUp.js for statistics animation -->
    <script src="https://cdn.jsdelivr.net/npm/countup@2.8.0/dist/countUp.min.js"></script>

    <!-- Site JavaScript -->
    <script src="js/main.js"></script>
    ```

    **IMPORTANT:** CountUp.js CDN MUST load BEFORE main.js. Main.js depends on CountUp being available in global scope.

    Then update commercial/js/main.js to add form alert behavior at the end of the file:

    ```javascript
    /**
     * Demo form submission handler
     * Prevents actual submission and shows alert to user
     */
    document.addEventListener('DOMContentLoaded', function() {
      const contactForm = document.querySelector('.contact__form');

      if (contactForm) {
        contactForm.addEventListener('submit', function(event) {
          event.preventDefault();
          alert('This is a demo form. In production, this would submit your message via Formspree or a similar service. Thank you for your interest!');
        });
      }
    });
    ```

    This ensures the form created in Plan 02 shows a clear message to users instead of failing silently or showing browser error.

    Also verify that all .stat__number elements in HTML have proper data-count attributes:
    - data-count="12" for "Years in Business"
    - data-count="500" data-suffix="+" for "Clients Served"
    - Add any other statistics as appropriate

    If data-count attributes are missing, add them to the HTML.
  </action>
  <verify>
    Open commercial/index.html in browser with DevTools console open. Check:
    1. No console errors (CountUp.js loads successfully)
    2. Scroll down to statistics section - numbers should animate from 0 to target values
    3. Scroll up and back down - animation should NOT repeat (already happened)
    4. Fill out contact form and submit - alert should appear with demo message
    5. Check Network tab - CountUp.js should load from cdn.jsdelivr.net (status 200)
  </verify>
  <done>
    CountUp.js CDN script tag added to index.html before main.js. Form submission alert handler added to main.js. All .stat__number elements have data-count attributes. Opening the site and scrolling to stats triggers animation, and form submission shows demo alert.
  </done>
</task>

</tasks>

<verification>
After completing both tasks:
1. Open commercial/index.html in browser with DevTools console open
2. Check console for errors - should be clean (no red errors)
3. Scroll down to statistics section slowly
   - Numbers should animate from 0 to target values (e.g., 12 for Years, 500+ for Clients)
   - Animation should be smooth with easing (not instant)
4. Scroll up and back down to stats section
   - Animation should NOT repeat (already played once)
5. Test form submission
   - Fill in Name, Email, Company, Message
   - Click "Send Message" button
   - Alert should appear: "This is a demo form..."
   - Page should NOT reload or navigate away
6. Check Network tab in DevTools
   - CountUp.js should load successfully from cdn.jsdelivr.net
   - main.js should load successfully from local js/ directory
7. Test on mobile viewport (375px)
   - Animations should work identically
</verification>

<success_criteria>
Plan complete when:
- [ ] commercial/js/main.js exists with 30+ lines
- [ ] CountUp.js CDN loads successfully (no 404 errors)
- [ ] Statistics animate from 0 to target when scrolling to stats section
- [ ] Animation only triggers once (doesn't repeat on subsequent scrolls)
- [ ] Form submission prevents default and shows alert message
- [ ] No console errors in browser DevTools
- [ ] Both features work on mobile and desktop viewports
</success_criteria>

<output>
After completion, create `.planning/phases/02-commercial-site/02-04-SUMMARY.md` documenting JavaScript features added, CountUp.js implementation details, IntersectionObserver usage, dependency on Plans 02 and 03, and any browser compatibility notes.
</output>
